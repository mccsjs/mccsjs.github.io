function dark(){const canvas=document.getElementById("universe");if(!canvas)return;const config={speed:0.05,colors:{giant:"180,184,240",normal:"226,225,142",comet:"226,225,224"}};let width,height,starsCount,ctx,stars=[];let showAllStars=true;function initCanvas(){width=window.innerWidth;height=window.innerHeight;starsCount=Math.floor(0.216*width);canvas.setAttribute("width",width);canvas.setAttribute("height",height)}function Star(){this.reset=function(){this.giant=random(3);this.comet=!this.giant&&!showAllStars&&random(10);this.x=randomNum(0,width-10);this.y=randomNum(0,height);this.r=randomNum(1.1,2.6);this.dx=randomNum(config.speed,6*config.speed)+(this.comet?config.speed*randomNum(50,120):0);this.dy=-randomNum(config.speed,6*config.speed)-(this.comet?config.speed*randomNum(50,120):0);this.fadingOut=null;this.fadingIn=true;this.opacity=0;this.opacityTresh=randomNum(0.2,this.comet?0.6:1);this.do=randomNum(0.0005,0.002)+(this.comet?0.001:0)};this.fadeIn=function(){if(this.fadingIn){this.fadingIn=this.opacity<=this.opacityTresh;this.opacity+=this.do}};this.fadeOut=function(){if(this.fadingOut){this.fadingOut=this.opacity>0;this.opacity-=this.do/2;if(this.x>width||this.y<0){this.fadingOut=false;this.reset()}}};this.draw=function(){ctx.beginPath();if(this.giant){ctx.fillStyle=`rgba(${config.colors.giant},${this.opacity})`;ctx.arc(this.x,this.y,2,0,2*Math.PI)}else if(this.comet){ctx.fillStyle=`rgba(${config.colors.comet},${this.opacity})`;ctx.arc(this.x,this.y,1.5,0,2*Math.PI);for(let i=0;i<30;i++){ctx.fillStyle=`rgba(${config.colors.comet},${this.opacity-this.opacity/20*i})`;ctx.rect(this.x-this.dx/4*i,this.y-this.dy/4*i-2,2,2);ctx.fill()}}else{ctx.fillStyle=`rgba(${config.colors.normal},${this.opacity})`;ctx.rect(this.x,this.y,this.r,this.r)}ctx.closePath();ctx.fill()};this.move=function(){this.x+=this.dx;this.y+=this.dy;if(!this.fadingOut&&(this.x>width-width/4||this.y<0)){this.fadingOut=true}};this.reset()}function random(probability){return Math.random()*1000<10*probability}function randomNum(min,max){return Math.random()*(max-min)+min}function animate(){ctx.clearRect(0,0,width,height);stars.forEach(star=>{star.move();star.fadeIn();star.fadeOut();star.draw()})}function render(){const isDarkMode=document.documentElement.getAttribute('data-theme')==='dark';if(isDarkMode)animate();requestAnimationFrame(render)}initCanvas();window.addEventListener("resize",initCanvas);ctx=canvas.getContext("2d");for(let i=0;i<starsCount;i++){stars.push(new Star())}setTimeout(()=>{showAllStars=false},50);render()}dark();class Cursor{constructor(){this.pos={curr:null,prev:null};this.pointerElements=[];this.create();this.init();this.render()}move(left,top){this.cursor.style.left=`${left}px`;this.cursor.style.top=`${top}px`}create(){if(!this.cursor){this.cursor=document.createElement("div");this.cursor.id="cursor";this.cursor.classList.add("hidden");document.body.append(this.cursor)}const elements=document.querySelectorAll('*');this.pointerElements=Array.from(elements).filter(el=>getComputedStyle(el).cursor==="pointer").map(el=>el.outerHTML);this.styleElement=document.createElement("style");this.styleElement.innerHTML=`*{cursor:url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8' width='8px' height='8px'><circle cx='4' cy='4' r='4' opacity='1.0' fill='rgb(0, 191, 255)'/></svg>")4 4,auto}`;document.body.appendChild(this.styleElement)}refresh(){this.styleElement?.remove();this.cursor.classList.remove("hover","active");this.pos={curr:null,prev:null};this.pointerElements=[];this.create();this.init()}init(){const isPointer=(element)=>this.pointerElements.includes(element.outerHTML);document.onmouseover=e=>isPointer(e.target)&&this.cursor.classList.add("hover");document.onmouseout=e=>isPointer(e.target)&&this.cursor.classList.remove("hover");document.onmousemove=e=>{if(!this.pos.curr){this.move(e.clientX-8,e.clientY-8)}this.pos.curr={x:e.clientX-8,y:e.clientY-8};this.cursor.classList.remove("hidden")};document.onmouseenter=()=>this.cursor.classList.remove("hidden");document.onmouseleave=()=>this.cursor.classList.add("hidden");document.onmousedown=()=>this.cursor.classList.add("active");document.onmouseup=()=>this.cursor.classList.remove("active")}render(){if(this.pos.prev){this.pos.prev.x=lerp(this.pos.prev.x,this.pos.curr.x,0.15);this.pos.prev.y=lerp(this.pos.prev.y,this.pos.curr.y,0.15);this.move(this.pos.prev.x,this.pos.prev.y)}else{this.pos.prev=this.pos.curr}requestAnimationFrame(()=>this.render())}}Math.lerp=(a,b,n)=>(1-n)*a+n*b;const lerp=Math.lerp;let CURSOR;(()=>{CURSOR=new Cursor()})();function owoBig(){const postComment=document.getElementById('post-comment');if(!postComment)return;let isHoverEnabled=true;let hoverTimer;const scale=3;const magnifier=document.createElement('div');magnifier.id='owo-big';document.body.appendChild(magnifier);const observer=new MutationObserver(mutations=>{mutations.forEach(mutation=>{mutation.addedNodes.forEach(node=>{if(node.nodeType!==1)return;let targetElement;if(mutation.addedNodes.length===2&&node.classList?.contains('OwO-body')){targetElement=mutation.addedNodes[1]}else if(mutation.addedNodes.length===1&&node.classList?.contains('tk-comment')){targetElement=node}if(targetElement){setupOwoEvents(targetElement,magnifier,isHoverEnabled,hoverTimer,scale)}})})});observer.observe(postComment,{subtree:true,childList:true})}function setupOwoEvents(element,magnifier,isHoverEnabled,hoverTimer,scale){if(document.body.clientWidth<=768){element.addEventListener('contextmenu',e=>e.preventDefault())}element.onmouseover=(e)=>{if(isHoverEnabled&&e.target.tagName==='IMG'){isHoverEnabled=false;hoverTimer=setTimeout(()=>{const height=e.target.clientHeight*scale;const width=e.target.clientWidth*scale;let left=e.x-e.offsetX-(width-e.target.clientWidth)/2;const top=e.y-e.offsetY;if(left+width>document.body.clientWidth){left-=(left+width)-document.body.clientWidth+10}if(left<0)left=10;magnifier.style.cssText=`display:flex;height:${height}px;width:${width}px;left:${left}px;top:${top}px;`;magnifier.innerHTML=`<img src="${e.target.src}"alt="æ”¾å¤§è¡¨æƒ…">`},300)}};element.onmouseout=()=>{magnifier.style.display='none';isHoverEnabled=true;clearTimeout(hoverTimer)}}if(document.getElementById('post-comment')){owoBig()}function debounce(fn,delay){let timer=null;return function(...args){if(timer)clearTimeout(timer);timer=setTimeout(()=>fn.apply(this,args),delay)}}document.addEventListener("copy",debounce(()=>{showNotification("å“å˜¿ï¼å¤åˆ¶æˆåŠŸğŸ¬","è‹¥è¦è½¬è½½æœ€å¥½ä¿ç•™åŸæ–‡é“¾æ¥å“¦ï¼Œç»™ä½ ä¸€ä¸ªå¤§å¤§çš„èµï¼")},300));const share=debounce(()=>{const url=window.location.origin+window.location.pathname;const title=document.title.endsWith("| mccsjsğŸ‹")?document.title.slice(0,-14):document.title;const shareText=`mccsjsğŸ‹çš„ç«™å†…åˆ†äº«\næ ‡é¢˜ï¼š${title}\né“¾æ¥ï¼š${url}\næ¬¢è¿æ¬¢è¿ï¼ğŸ§ğŸ§`;try{navigator.clipboard.writeText(shareText);showNotification("æˆåŠŸå¤åˆ¶åˆ†äº«ä¿¡æ¯ğŸ‰","æ‚¨ç°åœ¨å¯ä»¥é€šè¿‡ç²˜è´´ç›´æ¥è·Ÿå°ä¼™ä¼´åˆ†äº«äº†ï¼")}catch(err){console.error('å¤åˆ¶å¤±è´¥:',err)}},300);function showNotification(title,message){console.log(`Notification:${title}-${message}`)}